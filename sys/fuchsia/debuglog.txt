# Copyright 2022 syzkaller project authors. All rights reserved.
# Use of this source code is governed by Apache 2 LICENSE that can be found in the LICENSE file.

include <zircon/syscalls.h>

resource zx_log[zx_handle]

debuglog_create(resource_ zx_handle, options flags[debuglog_create_options], out ptr[out, zx_log])
debuglog_write(handle zx_log, options flags[debuglog_write_options], buffer ptr[in, array[int8]], buffer_size len[buffer])
debuglog_read(handle zx_log, options flags[debuglog_read_options], buffer ptr[out, array[int8]], buffer_size len[buffer])

debuglog_create_options = ZX_LOG_FLAG_READABLE
debuglog_write_options = 0
debuglog_read_options = 0

# unsupported on all arches (typo?)
# zx_log_record {
#   sequence int64
#   unused int32
#   datalen bytesize[data, int16]
#   severity int8
#   flags int8
#   timestamp zx_time
#   pid int64
#   tid int64
#   data array[int8]
# }
