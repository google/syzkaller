# Copyright 2026 syzkaller project authors. All rights reserved.
# Use of this source code is governed by Apache 2 LICENSE that can be found in the LICENSE file.

include <linux/ioctl.h>
include <uapi/linux/dvb/dmx.h>

resource fd_dvb_dvr[fd]

syz_open_dev$dvb_dvr(dev ptr[in, string["/dev/dvb/adapter#/dvr#"]], id intptr, flags flags[open_flags]) fd_dvb_dvr
ioctl$DVB_DVR_DMX_SET_BUFFER_SIZE(fd fd_dvb_dvr, cmd const[DMX_SET_BUFFER_SIZE], arg intptr)
ioctl$DVB_DVR_DMX_REQBUFS(fd fd_dvb_dvr, cmd const[DMX_REQBUFS], arg ptr[inout, dmx_requestbuffers])
ioctl$DVB_DVR_DMX_QUERYBUF(fd fd_dvb_dvr, cmd const[DMX_QUERYBUF], arg ptr[inout, dmx_buffer])
ioctl$DVB_DVR_DMX_EXPBUF(fd fd_dvb_dvr, cmd const[DMX_EXPBUF], arg ptr[inout, dmx_exportbuffer])
ioctl$DVB_DVR_DMX_QBUF(fd fd_dvb_dvr, cmd const[DMX_QBUF], arg ptr[inout, dmx_buffer])
ioctl$DVB_DVR_DMX_DQBUF(fd fd_dvb_dvr, cmd const[DMX_DQBUF], arg ptr[inout, dmx_buffer])
