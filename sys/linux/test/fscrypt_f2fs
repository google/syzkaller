# This program mounts an empty f2fs filesystem that supports encryption
# (generated by 'mkfs.f2fs -O encrypt'), then adds an encryption key to that
# filesystem and creates an encrypted directory using that key.

syz_mount_image$f2fs(&(0x7f0000000000)='f2fs\x00', &(0x7f0000000100)='./mnt\x00', 0x4000000, 0x26, &(0x7f0000000200)=[{&(0x7f0000010000)="1020f5f201000e0009000000030000000c000000090000000100000001000000000000000040000000000000180000001f0000000200000002000000020000000100000018000000000200000002000000060000000a0000000e000000100000030000000100000002000000a3bd865da4e84b259caac903308887eb00000000", 0x80, 0x400}, {&(0x7f0000010080)="00000000000000000000000000000000000000000000000000000000240000006d70000000000000776d0000000000006f670000000000006a7000000000000061766900000000006d347600000000006d347000000000006d6b7600000000006d6f7600000000007765626d0000000077617600000000006d3461000000000033677000000000006f70757300000000666c6163000000006769660000000000706e670000000000737667000000000077656270000000006a61720000000000646562000000000069736f0000000000677a000000000000787a0000000000007a737400000000007064660000000000707963000000000074746300000000007474660000000000657865000000000061706b0000000000636e74000000000065786f00000000006f646578000000007664657800000000736f0000000000006462000000000000000000000000000000000000000000000000000000000000", 0x160, 0x860}, {&(0x7f00000101e0)="000000004c696e75782076657273696f6e20352e31302e302d7263362d30303139332d6764616663366532346461663420286540736f6c2920286763632028474343292031302e322e302c20474e55206c642028474e552042696e7574696c732920322e33352e312920233120534d5020505245454d5054204d6f6e204e6f762033302031333a35323a33382050535420323032300000000000000000000000", 0xa0, 0xa80}, {&(0x7f0000010280)="000000004c696e75782076657273696f6e20352e31302e302d7263362d30303139332d6764616663366532346461663420286540736f6c2920286763632028474343292031302e322e302c20474e55206c642028474e552042696e7574696c732920322e33352e312920233120534d5020505245454d5054204d6f6e204e6f762033302031333a35323a33382050535420323032300000000000000000000000", 0xa0, 0xb80}, {&(0x7f0000010320)="0000000001000000000000000000000000000000000000000000000000000000", 0x20, 0xc80}, {&(0x7f0000010340)="0000000000010000000000000000000000000000000000000000000000000000", 0x20, 0xec0}, {&(0x7f0000010360)="1020f5f201000e0009000000030000000c000000090000000100000001000000000000000040000000000000180000001f0000000200000002000000020000000100000018000000000200000002000000060000000a0000000e000000100000030000000100000002000000a3bd865da4e84b259caac903308887eb00000000", 0x80, 0x1400}, {&(0x7f00000103e0)="00000000000000000000000000000000000000000000000000000000240000006d70000000000000776d0000000000006f670000000000006a7000000000000061766900000000006d347600000000006d347000000000006d6b7600000000006d6f7600000000007765626d0000000077617600000000006d3461000000000033677000000000006f70757300000000666c6163000000006769660000000000706e670000000000737667000000000077656270000000006a61720000000000646562000000000069736f0000000000677a000000000000787a0000000000007a737400000000007064660000000000707963000000000074746300000000007474660000000000657865000000000061706b0000000000636e74000000000065786f00000000006f646578000000007664657800000000736f0000000000006462000000000000000000000000000000000000000000000000000000000000", 0x160, 0x1860}, {&(0x7f0000010540)="000000004c696e75782076657273696f6e20352e31302e302d7263362d30303139332d6764616663366532346461663420286540736f6c2920286763632028474343292031302e322e302c20474e55206c642028474e552042696e7574696c732920322e33352e312920233120534d5020505245454d5054204d6f6e204e6f762033302031333a35323a33382050535420323032300000000000000000000000", 0xa0, 0x1a80}, {&(0x7f00000105e0)="000000004c696e75782076657273696f6e20352e31302e302d7263362d30303139332d6764616663366532346461663420286540736f6c2920286763632028474343292031302e322e302c20474e55206c642028474e552042696e7574696c732920322e33352e312920233120534d5020505245454d5054204d6f6e204e6f762033302031333a35323a33382050535420323032300000000000000000000000", 0xa0, 0x1b80}, {&(0x7f0000010680)="0000000001000000000000000000000000000000000000000000000000000000", 0x20, 0x1c80}, {&(0x7f00000106a0)="0000000000010000000000000000000000000000000000000000000000000000", 0x20, 0x1ec0}, {&(0x7f00000106c0)="0bd03b7500000000001000000000000002000000000000000d0000001000000012000000000000000100000002000000ffffffffffffffffffffffffffffffffffffffff01000000000000000000000000000000030000000b00000005000000ffffffffffffffffffffffffffffffffffffffff010000000000000000000000000000008501000006000000010000000100000001000000040000004000000040000000fc0f0000000000000000000000000000000000000000000000000000", 0xc0, 0x200000}, {&(0x7f0000010780)="00000000000000000000000000000000000000000000000000000000d9fa28d50100030000000003000000001000000000000000000000000000000000000000", 0x40, 0x200fe0}, {&(0x7f00000107c0)="000000000000000000000000000000000000000000000000000000060000000000010c8000000000000000000000000000000000000000000000000000000000", 0x40, 0x2011e0}, {&(0x7f0000010800)="0000000000000000000000010000000010000000000000000000000000000000", 0x20, 0x201240}, {&(0x7f0000010820)="0000000000000000000000000000000000000000000000000002000000001400", 0x20, 0x201280}, {&(0x7f0000010840)="0000000000000003000000010080000000000000000000000000000000000000", 0x20, 0x2012e0}, {&(0x7f0000010860)="0000000000000000000000000000000000000000000b00000000040000000000", 0x20, 0x201320}, {&(0x7f0000010880)="0000000500000000080000000000000000000000000000000000000000000000", 0x20, 0x201380}, {&(0x7f00000108a0)="0000000000000000000000000000000000000000000003000000000000000000", 0x20, 0x2013e0}, {&(0x7f00000108c0)="0300000000000000000000000000000000000000000000000000000000000000", 0x20, 0x202000}, {&(0x7f00000108e0)="0000000000000000000000000000000000000000000000000000000100000000", 0x20, 0x202fe0}, {&(0x7f0000010900)="0000000000000000000000000000000000000000000000000000000100000000", 0x20, 0x203fe0}, {&(0x7f0000010920)="00000000000000000000000000000000000000000000000000000001000000000bd03b7500000000001000000000000002000000000000000d0000001000000012000000000000000100000002000000ffffffffffffffffffffffffffffffffffffffff01000000000000000000000000000000030000000b00000005000000ffffffffffffffffffffffffffffffffffffffff010000000000000000000000000000008501000006000000010000000100000001000000040000004000000040000000fc0f0000000000000000000000000000000000000000000000000000", 0xe0, 0x204fe0}, {&(0x7f0000010a00)="00000000000000000000000000000000000000000000000000000000d9fa28d5", 0x20, 0x205fe0}, {&(0x7f0000010a20)="0bd03b75d9fa28d5000000000000000000000000000000000000000000000000", 0x20, 0x3ff000}, {&(0x7f0000010a40)="0000000000000000feffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000", 0x60, 0x3ff040}, {&(0x7f0000010aa0)="0000000000000000001000000000000002000000000000000d0000001000000012000000000000000100000002000000ffffffffffffffffffffffffffffffffffffffff01000000000000000000000000000000030000000b00000005000000ffffffffffffffffffffffffffffffffffffffff010000000000000000000000000000008501000006000000010000000100000001000000040000004000000040000000fc0f0000000000000000000000000000000000000000000000000000", 0xc0, 0x400000}, {&(0x7f0000010b60)="00000000000000000000000000000000000000000000000000000000d9a1f350", 0x20, 0x400fe0}, {&(0x7f0000010b80)="0000000000000000001000000000000002000000000000000d0000001000000012000000000000000100000002000000ffffffffffffffffffffffffffffffffffffffff01000000000000000000000000000000030000000b00000005000000ffffffffffffffffffffffffffffffffffffffff010000000000000000000000000000008501000006000000010000000100000001000000040000004000000040000000fc0f0000000000000000000000000000000000000000000000000000", 0xc0, 0x405000}, {&(0x7f0000010c40)="00000000000000000000000000000000000000000000000000000000d9a1f350", 0x20, 0x405fe0}, {&(0x7f0000010c60)="00000000000000000000010000000100000000020000000100000000030000000010000000000000000000000000000000000000000000000000000000000000", 0x40, 0xa00000}, {&(0x7f0000010ca0)="ed410000e8030000e8030000020000000010000000000000020000000000000055ffc65f0000000055ffc65f0000000055ffc65f0000000000000000000000000000000000000000010000000000000000000000000000000000000000000000", 0x60, 0x1000000}, {&(0x7f0000010d00)="0000000000000000001600000000000000000000000000000000000000000000", 0x20, 0x1000160}, {&(0x7f0000010d20)="0000000000000000030000000300000000000000010000000000000001100000", 0x20, 0x1000fe0}, {&(0x7f0000010d40)="03000000000000000000000000000000000000000000000000000000000000000000030000000100020000000003000000020002000000000000000000000000", 0x40, 0x1600000}, {&(0x7f0000010d80)="000000000000000000000000000000002e000000000000002e2e000000000000", 0x20, 0x1600940}], 0x0, &(0x7f0000010da0))
r0 = openat(0xffffffffffffff9c, &AUTO='mnt', 0x0, 0x0)
ioctl$FS_IOC_ADD_ENCRYPTION_KEY(r0, 0xc0506617, &AUTO={@id={0x2, 0x0, @a='\x69\xb2\xf6\xed\xee\xe7\x20\xcc\xe0\x57\x79\x37\xeb\x8a\x67\x51', [0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0]}, 0x40, 0x0, [0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0], @a='\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40'})
mkdirat(0xffffffffffffff9c, &AUTO='mnt/encrypted_dir\x00', 0x1c0)
r1 = openat(0xffffffffffffff9c, &AUTO='mnt/encrypted_dir\x00', 0x0, 0x0)
ioctl$FS_IOC_SET_ENCRYPTION_POLICY(r1, 0x800c6613, &AUTO=@v2={0x2, @aes256, 0x0, [0x0, 0x0, 0x0, 0x0], @a='\x69\xb2\xf6\xed\xee\xe7\x20\xcc\xe0\x57\x79\x37\xeb\x8a\x67\x51'})
r2 = openat(0xffffffffffffff9c, &AUTO='mnt/encrypted_dir/file\x00', 0x42, 0x180)
write(r2, &AUTO='foo', 0x3)
