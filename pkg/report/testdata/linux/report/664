TITLE: general protection fault in reiserfs_readdir_inode
ALT: bad-access in reiserfs_readdir_inode
TYPE: DoS
PANICKED: Y

[  464.245994][T13181] general protection fault, probably for non-canonical address 0xe0017c0000000006: 0000 [#1] PREEMPT SMP KASAN
[  464.257848][T13181] KASAN: maybe wild-memory-access in range [0x000c000000000030-0x000c000000000037]
[  464.262128][T13179] REISERFS warning (device loop2): sh-2011 read_super_block: can't find a reiserfs filesystem on (dev loop2, block 16, size 4096)
[  464.267121][T13181] CPU: 1 PID: 13181 Comm: syz-executor.0 Not tainted 6.0.0-syzkaller-09589-g55be6084c8e0 #0
[  464.267148][T13181] Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/22/2022
[  464.267158][T13181] RIP: 0010:mutex_optimistic_spin+0x12d/0x2d0
[  464.267186][T13181] Code: 89 d8 48 c1 e8 03 42 80 3c 28 00 74 08 48 89 df e8 08 99 75 00 4c 8b 23 49 83 e4 f8 74 72 49 8d 6c 24 34 48 89 e8 48 c1 e8 03 <42> 8a 04 28 84 c0 0f 85 4f 01 00 00 83 7d 00 00 74 78 49 83 c4 14
[  464.267201][T13181] RSP: 0018:ffffc90004bf77e8 EFLAGS: 00010207
[  464.267218][T13181] RAX: 0001800000000006 RBX: ffff88801dc69228 RCX: ffffffff81676b52
[  464.280842][T13179] REISERFS warning (device loop2): sh-2021 reiserfs_fill_super: can not find reiserfs on loop2
[  464.290615][T13181] RDX: 0000000000000000 RSI: 0000000000000008 RDI: ffff88801dc69228
[  464.290632][T13181] RBP: 000c000000000034 R08: dffffc0000000000 R09: ffffed1003b8d246
[  464.290646][T13181] R10: ffffed1003b8d246 R11: 1ffff11003b8d245 R12: 000c000000000000
[  464.290659][T13181] R13: dffffc0000000000 R14: 0000000000000000 R15: 0000000000000000
[  464.290669][T13181] FS:  00007fed86ab8700(0000) GS:ffff8880b9b00000(0000) knlGS:0000000000000000
[  464.290686][T13181] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  464.290698][T13181] CR2: 00007fed85913e09 CR3: 000000007cedc000 CR4: 00000000003506e0
[  464.290713][T13181] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[  464.290724][T13181] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[  464.421821][T13181] Call Trace:
[  464.425096][T13181]  <TASK>
[  464.428017][T13181]  __mutex_lock_common+0x210/0x26c0
[  464.474666][T13181]  mutex_lock_nested+0x17/0x20
[  464.479420][T13181]  reiserfs_write_lock+0x77/0xd0
[  464.484354][T13181]  reiserfs_readdir_inode+0x170/0x1470
[  464.573964][T13181]  iterate_dir+0x257/0x5f0
[  464.583569][T13181]  __se_sys_getdents+0x1e9/0x4a0
[  464.608938][T13181]  do_syscall_64+0x2b/0x70
[  464.613346][T13181]  entry_SYSCALL_64_after_hwframe+0x63/0xcd
[  464.619234][T13181] RIP: 0033:0x7fed8588b5a9
[  464.623640][T13181] Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
[  464.643240][T13181] RSP: 002b:00007fed86ab8168 EFLAGS: 00000246 ORIG_RAX: 000000000000004e
[  464.651642][T13181] RAX: ffffffffffffffda RBX: 00007fed859abf80 RCX: 00007fed8588b5a9
[  464.659605][T13181] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000003
[  464.667563][T13181] RBP: 00007fed858e6580 R08: 0000000000000000 R09: 0000000000000000
[  464.675522][T13181] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
[  464.683508][T13181] R13: 00007ffd3696e99f R14: 00007fed86ab8300 R15: 0000000000022000
[  464.691500][T13181]  </TASK>
[  464.694513][T13181] Modules linked in:
[  464.699156][T13181] ---[ end trace 0000000000000000 ]---
[  464.704654][T13181] RIP: 0010:mutex_optimistic_spin+0x12d/0x2d0
[  464.710742][T13181] Code: 89 d8 48 c1 e8 03 42 80 3c 28 00 74 08 48 89 df e8 08 99 75 00 4c 8b 23 49 83 e4 f8 74 72 49 8d 6c 24 34 48 89 e8 48 c1 e8 03 <42> 8a 04 28 84 c0 0f 85 4f 01 00 00 83 7d 00 00 74 78 49 83 c4 14
[  464.730391][T13181] RSP: 0018:ffffc90004bf77e8 EFLAGS: 00010207
[  464.736496][T13181] RAX: 0001800000000006 RBX: ffff88801dc69228 RCX: ffffffff81676b52
[  464.744497][T13181] RDX: 0000000000000000 RSI: 0000000000000008 RDI: ffff88801dc69228
[  464.752477][T13181] RBP: 000c000000000034 R08: dffffc0000000000 R09: ffffed1003b8d246
[  464.760480][T13181] R10: ffffed1003b8d246 R11: 1ffff11003b8d245 R12: 000c000000000000
[  464.768489][T13181] R13: dffffc0000000000 R14: 0000000000000000 R15: 0000000000000000
[  464.776500][T13181] FS:  00007fed86ab8700(0000) GS:ffff8880b9b00000(0000) knlGS:0000000000000000
[  464.785472][T13181] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  464.792073][T13181] CR2: 00007fed85913e09 CR3: 000000007cedc000 CR4: 00000000003506e0
[  464.800089][T13181] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[  464.808098][T13181] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[  464.816109][T13181] Kernel panic - not syncing: Fatal exception
[  464.822340][T13181] Kernel Offset: disabled
[  464.826920][T13181] Rebooting in 86400 seconds..
