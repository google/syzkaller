TITLE: KMSAN: uninit-value in alg_setkey
ALT: bad-access in alg_setkey
TYPE: KMSAN-UNINIT-VALUE
EXECUTOR: proc=2, id=690


=====================================================
BUG: KMSAN: uninit-value in aes_encrypt+0x1239/0x1960
 aes_encrypt+0x1239/0x1960
 aesti_encrypt+0x7d/0xf0
 cipher_crypt_one+0x120/0x2e0
 crypto_cipher_encrypt_one+0x33/0x40
 drbg_ctr_update+0x19a9/0x3700
 drbg_seed+0xb1e/0xe20
 drbg_kcapi_seed+0x19b2/0x1e40
 crypto_rng_reset+0x193/0x250
 rng_setkey+0x52/0x70
 alg_setkey+0x265/0x3b0
 alg_setsockopt+0x503/0x760
 __sys_setsockopt+0x43e/0x580
 __x64_sys_setsockopt+0xf4/0x1a0
 x64_sys_call+0x27c9/0x3e30
 do_syscall_64+0xd9/0x210
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

<Zero or more stacks not recorded to save memory>

Uninit was stored to memory at:
 crypto_sha3_finup+0x136/0xe00
 crypto_shash_finup+0x327/0xe80
 jent_hash_time+0x247/0x590
 jent_condition_data+0x4f0/0x510
 jent_measure_jitter+0x547/0x770
 jent_gen_entropy+0x209/0x450
 jent_read_entropy+0x353/0xeb0
 jent_kcapi_random+0x6c/0x250
 drbg_seed+0x3f5/0xe20
 drbg_kcapi_seed+0x19b2/0x1e40
 crypto_rng_reset+0x193/0x250
 rng_setkey+0x52/0x70
 alg_setkey+0x265/0x3b0
 alg_setsockopt+0x503/0x760
 __sys_setsockopt+0x43e/0x580
 __x64_sys_setsockopt+0xf4/0x1a0
 x64_sys_call+0x27c9/0x3e30
 do_syscall_64+0xd9/0x210
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

Uninit was stored to memory at:
 crypto_shash_finup+0xc5a/0xe80
 jent_hash_time+0x1de/0x590
 jent_condition_data+0x4f0/0x510
 jent_measure_jitter+0x547/0x770
 jent_gen_entropy+0x209/0x450
 jent_read_entropy+0x353/0xeb0
 jent_kcapi_random+0x6c/0x250
 drbg_seed+0x3f5/0xe20
 drbg_kcapi_seed+0x19b2/0x1e40
 crypto_rng_reset+0x193/0x250
 rng_setkey+0x52/0x70
 alg_setkey+0x265/0x3b0
 alg_setsockopt+0x503/0x760
 __sys_setsockopt+0x43e/0x580
 __x64_sys_setsockopt+0xf4/0x1a0
 x64_sys_call+0x27c9/0x3e30
 do_syscall_64+0xd9/0x210
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

Uninit was stored to memory at:
 crypto_sha3_finup+0xc98/0xe00
 crypto_shash_finup+0x327/0xe80
 jent_hash_time+0x247/0x590
 jent_condition_data+0x4f0/0x510
 jent_measure_jitter+0x547/0x770
 jent_gen_entropy+0x209/0x450
 jent_read_entropy+0x353/0xeb0
 jent_kcapi_random+0x6c/0x250
 drbg_seed+0x3f5/0xe20
 drbg_kcapi_seed+0x19b2/0x1e40
 crypto_rng_reset+0x193/0x250
 rng_setkey+0x52/0x70
 alg_setkey+0x265/0x3b0
 alg_setsockopt+0x503/0x760
 __sys_setsockopt+0x43e/0x580
 __x64_sys_setsockopt+0xf4/0x1a0
 x64_sys_call+0x27c9/0x3e30
 do_syscall_64+0xd9/0x210
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

Uninit was stored to memory at:
 keccakf+0x1efb/0x2110
 crypto_sha3_finup+0x772/0xe00
 crypto_shash_finup+0x327/0xe80
 jent_hash_time+0x247/0x590
 jent_condition_data+0x4f0/0x510
 jent_measure_jitter+0x547/0x770
 jent_gen_entropy+0x209/0x450
 jent_read_entropy+0x353/0xeb0
 jent_kcapi_random+0x6c/0x250
 drbg_seed+0x3f5/0xe20
 drbg_kcapi_seed+0x19b2/0x1e40
 crypto_rng_reset+0x193/0x250
 rng_setkey+0x52/0x70
 alg_setkey+0x265/0x3b0
 alg_setsockopt+0x503/0x760
 __sys_setsockopt+0x43e/0x580
 __x64_sys_setsockopt+0xf4/0x1a0
 x64_sys_call+0x27c9/0x3e30
 do_syscall_64+0xd9/0x210
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

Uninit was stored to memory at:
 crypto_sha3_finup+0x5be/0xe00
 crypto_shash_finup+0x327/0xe80
 jent_hash_time+0x247/0x590
 jent_condition_data+0x4f0/0x510
 jent_measure_jitter+0x547/0x770
 jent_gen_entropy+0x209/0x450
 jent_read_entropy+0x353/0xeb0
 jent_kcapi_random+0x6c/0x250
 drbg_seed+0x3f5/0xe20
 drbg_kcapi_seed+0x19b2/0x1e40
 crypto_rng_reset+0x193/0x250
 rng_setkey+0x52/0x70
 alg_setkey+0x265/0x3b0
 alg_setsockopt+0x503/0x760
 __sys_setsockopt+0x43e/0x580
 __x64_sys_setsockopt+0xf4/0x1a0
 x64_sys_call+0x27c9/0x3e30
 do_syscall_64+0xd9/0x210
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

Uninit was stored to memory at:
 crypto_sha3_finup+0x136/0xe00
 crypto_shash_finup+0x327/0xe80
 jent_hash_time+0x247/0x590
 jent_condition_data+0x4f0/0x510
 jent_measure_jitter+0x547/0x770
 jent_gen_entropy+0x209/0x450
 jent_read_entropy+0x353/0xeb0
 jent_kcapi_random+0x6c/0x250
 drbg_seed+0x3f5/0xe20
 drbg_kcapi_seed+0x19b2/0x1e40
 crypto_rng_reset+0x193/0x250
 rng_setkey+0x52/0x70
 alg_setkey+0x265/0x3b0
 alg_setsockopt+0x503/0x760
 __sys_setsockopt+0x43e/0x580
 __x64_sys_setsockopt+0xf4/0x1a0
 x64_sys_call+0x27c9/0x3e30
 do_syscall_64+0xd9/0x210
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

Uninit was stored to memory at:
 crypto_shash_finup+0xc5a/0xe80
 jent_hash_time+0x1de/0x590
 jent_condition_data+0x4f0/0x510
 jent_measure_jitter+0x547/0x770
 jent_gen_entropy+0x209/0x450
 jent_read_entropy+0x353/0xeb0
 jent_kcapi_random+0x6c/0x250
 drbg_seed+0x3f5/0xe20
 drbg_kcapi_seed+0x19b2/0x1e40
 crypto_rng_reset+0x193/0x250
 rng_setkey+0x52/0x70
 alg_setkey+0x265/0x3b0
 alg_setsockopt+0x503/0x760
 __sys_setsockopt+0x43e/0x580
 __x64_sys_setsockopt+0xf4/0x1a0
 x64_sys_call+0x27c9/0x3e30
 do_syscall_64+0xd9/0x210
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

Local variable intermediary created at:
 jent_hash_time+0x9b/0x590
 jent_condition_data+0x4f0/0x510

CPU: 0 UID: 0 PID: 8436 Comm: syz.2.690 Not tainted syzkaller #0 PREEMPT(none) 
Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.2-debian-1.16.2-1 04/01/2014
=====================================================
