TITLE: general protection fault in mremap
ALT: bad-access in __se_sys_mremap
ALT: bad-access in mremap
ALT: bad-access in sys_mremap
ALT: general protection fault in __se_sys_mremap
ALT: general protection fault in sys_mremap
TYPE: DoS
FRAME: mremap

[   89.184911][ T5827] Oops: general protection fault, probably for non-canonical address 0xdffffc0000000004: 0000 [#1] SMP KASAN PTI
[   89.196849][ T5827] KASAN: null-ptr-deref in range [0x0000000000000020-0x0000000000000027]
[   89.205390][ T5827] CPU: 1 UID: 0 PID: 5827 Comm: syz-executor187 Not tainted 6.14.0-syzkaller-12456-gacc4d5ff0b61 #0 PREEMPT(full) 
[   89.217482][ T5827] Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 02/12/2025
[   89.227562][ T5827] RIP: 0010:__se_sys_mremap+0x25fa/0x2c00
[   89.233366][ T5827] Code: c0 0f 85 0e 05 00 00 0f b6 9c 24 20 03 00 00 31 ff 89 de e8 68 9c ad ff 85 db 0f 84 7b 01 00 00 e8 5b 99 ad ff e9 9e 00 00 00 <80> 78 04 00 74 0a bf 20 00 00 00 e8 46 2d 15 00 4c 8b 34 25 20 00
[   89.252997][ T5827] RSP: 0018:ffffc9000414fb40 EFLAGS: 00010246
[   89.259187][ T5827] RAX: dffffc0000000000 RBX: 0000000000000000 RCX: 1ffff92000829fca
[   89.267167][ T5827] RDX: 0000000000000000 RSI: 0000000010000000 RDI: 0000000000000000
[   89.275236][ T5827] RBP: ffffc9000414ff00 R08: ffffffff821a7ea4 R09: ffffffff8c1f2397
[   89.283219][ T5827] R10: 0000000000000004 R11: ffff888030613c00 R12: 0000200000000000
[   89.291202][ T5827] R13: ffff888077690780 R14: 00000000180000fa R15: ffffc9000414fcd0
[   89.299274][ T5827] FS:  000055555d82a380(0000) GS:ffff8881250cf000(0000) knlGS:0000000000000000
[   89.308208][ T5827] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   89.314797][ T5827] CR2: 00002000000000c0 CR3: 0000000034a4a000 CR4: 00000000003526f0
[   89.322812][ T5827] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[   89.330788][ T5827] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[   89.338872][ T5827] Call Trace:
[   89.342342][ T5827]  <TASK>
[   89.345285][ T5827]  ? __pfx___se_sys_mremap+0x10/0x10
[   89.350599][ T5827]  ? _raw_spin_lock_irq+0xdf/0x120
[   89.355732][ T5827]  ? __pfx__raw_spin_lock_irq+0x10/0x10
[   89.361294][ T5827]  ? _raw_spin_unlock_irq+0x23/0x50
[   89.366587][ T5827]  ? lockdep_hardirqs_on+0x9d/0x150
[   89.371800][ T5827]  ? _raw_spin_unlock_irq+0x2e/0x50
[   89.377093][ T5827]  ? ptrace_notify+0x282/0x390
[   89.381877][ T5827]  ? __x64_sys_mremap+0x20/0xc0
[   89.386738][ T5827]  do_syscall_64+0xf3/0x230
[   89.391249][ T5827]  ? clear_bhb_loop+0x45/0xa0
[   89.396018][ T5827]  entry_SYSCALL_64_after_hwframe+0x77/0x7f
[   89.401919][ T5827] RIP: 0033:0x7f56a8c90369
[   89.406350][ T5827] Code: 48 83 c4 28 c3 e8 37 17 00 00 0f 1f 80 00 00 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
[   89.425960][ T5827] RSP: 002b:00007ffc63c1c6c8 EFLAGS: 00000246 ORIG_RAX: 0000000000000019
[   89.434379][ T5827] RAX: ffffffffffffffda RBX: 0000200000000000 RCX: 00007f56a8c90369
[   89.442366][ T5827] RDX: 0000000000004000 RSI: 0000000000001000 RDI: 0000200000000000
[   89.450351][ T5827] RBP: 0000200000001000 R08: 0000200000001000 R09: 0000000000000000
[   89.458504][ T5827] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000001
[   89.466477][ T5827] R13: 00007ffc63c1c8a8 R14: 0000000000000001 R15: 0000000000000001
[   89.474461][ T5827]  </TASK>
[   89.477490][ T5827] Modules linked in:
[   89.481764][ T5827] ---[ end trace 0000000000000000 ]---
[   89.488831][ T5827] RIP: 0010:__se_sys_mremap+0x25fa/0x2c00
[   89.494716][ T5827] Code: c0 0f 85 0e 05 00 00 0f b6 9c 24 20 03 00 00 31 ff 89 de e8 68 9c ad ff 85 db 0f 84 7b 01 00 00 e8 5b 99 ad ff e9 9e 00 00 00 <80> 78 04 00 74 0a bf 20 00 00 00 e8 46 2d 15 00 4c 8b 34 25 20 00
[   89.515104][ T5827] RSP: 0018:ffffc9000414fb40 EFLAGS: 00010246
[   89.521416][ T5827] RAX: dffffc0000000000 RBX: 0000000000000000 RCX: 1ffff92000829fca
[   89.529455][ T5827] RDX: 0000000000000000 RSI: 0000000010000000 RDI: 0000000000000000
[   89.537556][ T5827] RBP: ffffc9000414ff00 R08: ffffffff821a7ea4 R09: ffffffff8c1f2397
[   89.545652][ T5827] R10: 0000000000000004 R11: ffff888030613c00 R12: 0000200000000000
[   89.553718][ T5827] R13: ffff888077690780 R14: 00000000180000fa R15: ffffc9000414fcd0
[   89.562101][ T5827] FS:  000055555d82a380(0000) GS:ffff8881250cf000(0000) knlGS:0000000000000000
[   89.571081][ T5827] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[   89.577797][ T5827] CR2: 00002000000000c0 CR3: 0000000034a4a000 CR4: 00000000003526f0
[   89.585809][ T5827] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[   89.593846][ T5827] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[   89.601905][ T5827] Kernel panic - not syncing: Fatal exception
[   89.608257][ T5827] Kernel Offset: disabled
[   89.612592][ T5827] Rebooting in 86400 seconds..
