TITLE: BUG: soft lockup in sys_rmdir
TYPE: HANG

[  281.646907] watchdog: BUG: soft lockup - CPU#1 stuck for 134s! [syz-executor4:4588]
[  281.654759] Modules linked in:
[  281.657946] irq event stamp: 76609500
[  281.661752] hardirqs last  enabled at (76609499): [<ffffffff81c66ccf>] d_walk+0x80f/0xc80
[  281.670066] hardirqs last disabled at (76609500): [<ffffffff87800905>] interrupt_entry+0xb5/0xf0
[  281.679024] softirqs last  enabled at (468244): [<ffffffff87a00778>] __do_softirq+0x778/0xaf5
[  281.687696] softirqs last disabled at (468177): [<ffffffff814762c1>] irq_exit+0x1d1/0x200
[  281.696008] CPU: 1 PID: 4588 Comm: syz-executor4 Not tainted 4.17.0-rc7+ #81
[  281.703881] Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
[  281.713233] RIP: 0010:d_walk+0x840/0xc80
[  281.717286] RSP: 0018:ffff880183f5f9f8 EFLAGS: 00000293 ORIG_RAX: ffffffffffffff13
[  281.724995] RAX: ffff8801b0d3c680 RBX: 0000000000000293 RCX: 1ffff100361a79e5
[  281.732263] RDX: 0000000000000000 RSI: ffffffff81c66cfb RDI: 0000000000000293
[  281.739552] RBP: ffff880183f5fb78 R08: ffff8801b0d3ceb8 R09: 0000000000000006
[  281.746815] R10: ffff8801b0d3c680 R11: 0000000000000000 R12: 0000000000000200
[  281.754080] R13: dffffc0000000000 R14: 1ffff100307ebf82 R15: ffff880183f5fb50
[  281.761359] FS:  000000000217c940(0000) GS:ffff8801daf00000(0000) knlGS:0000000000000000
[  281.769577] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  281.775450] CR2: 00007ffca8309eac CR3: 0000000183eb2000 CR4: 00000000001406e0
[  281.782717] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[  281.789980] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[  281.797240] Call Trace:
[  281.829726]  shrink_dcache_parent+0x179/0x230
[  281.859894]  vfs_rmdir+0x202/0x470
[  281.863431]  do_rmdir+0x523/0x610
[  281.890027]  __x64_sys_rmdir+0x36/0x40
[  281.893915]  do_syscall_64+0x1b1/0x800
[  281.922815]  entry_SYSCALL_64_after_hwframe+0x49/0xbe
[  281.927998] RIP: 0033:0x455777
[  281.931184] RSP: 002b:00007ffca830a5b8 EFLAGS: 00000206 ORIG_RAX: 0000000000000054
[  281.938889] RAX: ffffffffffffffda RBX: 0000000000000065 RCX: 0000000000455777
[  281.946179] RDX: 0000000000000000 RSI: 00007ffca830c360 RDI: 00007ffca830c360
[  281.953444] RBP: 00007ffca830c360 R08: 0000000000000000 R09: 0000000000000001
[  281.960792] R10: 0000000000000006 R11: 0000000000000206 R12: 000000000217d940
[  281.968057] R13: 0000000000000000 R14: 0000000000000198 R15: 000000000001f12d
[  281.994904] Sending NMI from CPU 1 to CPUs 0:
[  281.999398] NMI backtrace for cpu 0
[  281.999408] CPU: 0 PID: 4581 Comm: syz-executor6 Not tainted 4.17.0-rc7+ #81
[  281.999413] Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
[  281.999428] RIP: 0010:select_collect+0x249/0x5f0
[  281.999433] RSP: 0018:ffff880189947908 EFLAGS: 00000286
[  281.999440] RAX: 0000000000000000 RBX: ffffed0031328f24 RCX: ffffffff81c5c3b4
[  281.999445] RDX: 0000000000000000 RSI: ffffffff81c5c4fa RDI: ffff880189947c28
[  281.999450] RBP: ffff8801899479e8 R08: ffff88018993e5c0 R09: ffffed0039dde7a4
[  281.999455] R10: ffffed0039dde7a4 R11: ffff8801ceef3d23 R12: 0000000000000000
[  281.999461] R13: 1ffff10031328f28 R14: ffff880189947c18 R15: dffffc0000000000
[  281.999468] FS:  0000000001790940(0000) GS:ffff8801dae00000(0000) knlGS:0000000000000000
[  281.999474] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  281.999479] CR2: 00007ffebea69e9c CR3: 000000018989f000 CR4: 00000000001406f0
[  281.999487] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[  281.999491] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[  281.999493] Call Trace:
[  281.999541]  d_walk+0x3c3/0xc80
[  281.999601]  shrink_dcache_parent+0x179/0x230
[  281.999670]  vfs_rmdir+0x202/0x470
[  281.999679]  do_rmdir+0x523/0x610
[  281.999740]  __x64_sys_rmdir+0x36/0x40
[  281.999748]  do_syscall_64+0x1b1/0x800
[  281.999806]  entry_SYSCALL_64_after_hwframe+0x49/0xbe
[  281.999812] RIP: 0033:0x455777
[  281.999816] RSP: 002b:00007ffebea6a5a8 EFLAGS: 00000202 ORIG_RAX: 0000000000000054
[  281.999824] RAX: ffffffffffffffda RBX: 0000000000000065 RCX: 0000000000455777
[  281.999829] RDX: 0000000000000000 RSI: 00007ffebea6c350 RDI: 00007ffebea6c350
[  281.999833] RBP: 00007ffebea6c350 R08: 0000000000000000 R09: 0000000000000001
[  281.999838] R10: 0000000000000006 R11: 0000000000000202 R12: 0000000001791940
[  281.999843] R13: 0000000000000000 R14: 0000000000000192 R15: 000000000001f12b
[  282.000407] Kernel panic - not syncing: softlockup: hung tasks
[  282.316419] CPU: 1 PID: 4588 Comm: syz-executor4 Tainted: G             L    4.17.0-rc7+ #81
[  282.324992] Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
[  282.334334] Call Trace:
[  282.336997]  <IRQ>
[  282.339152]  dump_stack+0x1b9/0x294
[  282.352760]  panic+0x22f/0x4de
[  282.375494]  watchdog_timer_fn.cold.5+0xf3/0x126
[  282.380251]  __hrtimer_run_queues+0x3e3/0x10a0
[  282.432572]  hrtimer_interrupt+0x2f3/0x750
[  282.436818]  smp_apic_timer_interrupt+0x15d/0x710
[  282.468292]  apic_timer_interrupt+0xf/0x20
[  282.472527]  </IRQ>
[  282.474759] RIP: 0010:d_walk+0x840/0xc80
[  282.478811] RSP: 0018:ffff880183f5f9f8 EFLAGS: 00000293 ORIG_RAX: ffffffffffffff13
[  282.486516] RAX: ffff8801b0d3c680 RBX: 0000000000000293 RCX: 1ffff100361a79e5
[  282.493778] RDX: 0000000000000000 RSI: ffffffff81c66cfb RDI: 0000000000000293
[  282.501043] RBP: ffff880183f5fb78 R08: ffff8801b0d3ceb8 R09: 0000000000000006
[  282.508310] R10: ffff8801b0d3c680 R11: 0000000000000000 R12: 0000000000000200
[  282.515587] R13: dffffc0000000000 R14: 1ffff100307ebf82 R15: ffff880183f5fb50
[  282.556091]  shrink_dcache_parent+0x179/0x230
[  282.586289]  vfs_rmdir+0x202/0x470
[  282.589830]  do_rmdir+0x523/0x610
[  282.616379]  __x64_sys_rmdir+0x36/0x40
[  282.620264]  do_syscall_64+0x1b1/0x800
[  282.649064]  entry_SYSCALL_64_after_hwframe+0x49/0xbe
[  282.654251] RIP: 0033:0x455777
[  282.657434] RSP: 002b:00007ffca830a5b8 EFLAGS: 00000206 ORIG_RAX: 0000000000000054
[  282.665140] RAX: ffffffffffffffda RBX: 0000000000000065 RCX: 0000000000455777
[  282.672404] RDX: 0000000000000000 RSI: 00007ffca830c360 RDI: 00007ffca830c360
[  282.679668] RBP: 00007ffca830c360 R08: 0000000000000000 R09: 0000000000000001
[  282.687015] R10: 0000000000000006 R11: 0000000000000206 R12: 000000000217d940
[  282.694282] R13: 0000000000000000 R14: 0000000000000198 R15: 000000000001f12d
[  282.702335] Dumping ftrace buffer:
[  282.706164]    (ftrace buffer empty)
[  282.709862] Kernel Offset: disabled
[  282.713505] Rebooting in 86400 seconds..
