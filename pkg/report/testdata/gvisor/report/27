TITLE: panic: header.ScopeForIPv6Address(IP): bad address

panic: header.ScopeForIPv6Address(172.20.20.24): bad address

goroutine 560 [running]:
panic(0x16d8ca0, 0xc0001530d0)
	GOROOT/src/runtime/panic.go:1064 +0x470 fp=0xc0005725f8 sp=0xc000572540 pc=0x439090
gvisor.dev/gvisor/pkg/tcpip/network/ipv6.(*endpoint).acquireOutgoingPrimaryAddressRLocked(0xc00003c540, 0xc00063f9dc, 0x4, 0x44a500, 0x44a665, 0x156d900)
	pkg/tcpip/network/ipv6/ipv6.go:1339 +0x3ec fp=0xc0005726f0 sp=0xc0005725f8 pc=0xf2e70c
gvisor.dev/gvisor/pkg/tcpip/network/ipv6.(*endpoint).AcquireOutgoingPrimaryAddress(0xc00003c540, 0xc00063f9dc, 0x4, 0x7f4246154d00, 0x0, 0x0)
	pkg/tcpip/network/ipv6/ipv6.go:1293 +0xd5 fp=0xc000572780 sp=0xc0005726f0 pc=0xf2e2b5
gvisor.dev/gvisor/pkg/tcpip/stack.(*NIC).primaryEndpoint(0xc00059a780, 0x86dd, 0xc00063f9dc, 0x4, 0xc00027cc00, 0x1a9ac00)
	pkg/tcpip/stack/nic.go:340 +0x16a fp=0xc0005727f8 sp=0xc000572780 pc=0xc5302a
gvisor.dev/gvisor/pkg/tcpip/stack.(*Stack).getAddressEP(0xc00041b080, 0xc00059a780, 0x0, 0x0, 0xc00063f9dc, 0x4, 0x86dd, 0x0, 0x24)
	pkg/tcpip/stack/stack.go:1212 +0x6f fp=0xc000572868 sp=0xc0005727f8 pc=0xc66acf
gvisor.dev/gvisor/pkg/tcpip/stack.(*Stack).FindRoute(0xc00041b080, 0x0, 0x0, 0x0, 0xc00063f9dc, 0x4, 0x86dd, 0x0, 0x0)
	pkg/tcpip/stack/stack.go:1362 +0xec5 fp=0xc000572bd8 sp=0xc000572868 pc=0xc68125
gvisor.dev/gvisor/pkg/tcpip/transport/raw.(*endpoint).write(0xc00003c700, 0x1a7d000, 0xc000195040, 0xc00078a600, 0xc000000000, 0xc000572e50, 0xc000572d80, 0x40fcf8)
	pkg/tcpip/transport/raw/endpoint.go:336 +0x27c fp=0xc000572d20 sp=0xc000572bd8 pc=0xe918dc
gvisor.dev/gvisor/pkg/tcpip/transport/raw.(*endpoint).Write(0xc00003c700, 0x1a7d000, 0xc000195040, 0xc00078a600, 0xc000000000, 0x4, 0x4e21, 0xc000570002)
	pkg/tcpip/transport/raw/endpoint.go:230 +0xa5 fp=0xc000572d90 sp=0xc000572d20 pc=0xe91385
gvisor.dev/gvisor/pkg/sentry/socket/netstack.(*socketOpsCommon).SendMsg(0xc0005376f0, 0xc0005aca80, 0x1a98580, 0xc000246000, 0x0, 0x0, 0x0, 0x0, 0x100, 0xc00063fa00, ...)
	pkg/sentry/socket/netstack/netstack.go:2848 +0x23d fp=0xc000573128 sp=0xc000572d90 pc=0xf5d71d
gvisor.dev/gvisor/pkg/sentry/socket/netstack.(*SocketVFS2).SendMsg(0xc000537680, 0xc0005aca80, 0x1a98580, 0xc000246000, 0x0, 0x0, 0x0, 0x0, 0x100, 0xc00063fa00, ...)
	<autogenerated>:1 +0x178 fp=0xc0005732e8 sp=0xc000573128 pc=0xf71cf8
gvisor.dev/gvisor/pkg/sentry/syscalls/linux/vfs2.sendSingleMsg(0xc0005aca80, 0x7f424616a220, 0xc000537680, 0xc000537680, 0x20001540, 0x4000, 0x1, 0xc000573690, 0x0)
	pkg/sentry/syscalls/linux/vfs2/socket.go:1056 +0x41a fp=0xc000573618 sp=0xc0005732e8 pc=0x1309dfa
gvisor.dev/gvisor/pkg/sentry/syscalls/linux/vfs2.SendMMsg(0xc0005aca80, 0x3, 0x20001540, 0x1, 0x4000, 0x1, 0x1, 0x0, 0x0, 0x0, ...)
	pkg/sentry/syscalls/linux/vfs2/socket.go:980 +0x31a fp=0xc000573730 sp=0xc000573618 pc=0x130961a
gvisor.dev/gvisor/pkg/sentry/kernel.(*Task).executeSyscall(0xc0005aca80, 0x133, 0x3, 0x20001540, 0x1, 0x4000, 0x1, 0x1, 0x13, 0x137d3e0, ...)
	pkg/sentry/kernel/task_syscall.go:104 +0x453 fp=0xc0005739d0 sp=0xc000573730 pc=0xd60113
gvisor.dev/gvisor/pkg/sentry/kernel.(*Task).doSyscallInvoke(0xc0005aca80, 0x133, 0x3, 0x20001540, 0x1, 0x4000, 0x1, 0x1, 0x408638, 0xc0005ad35f)
	pkg/sentry/kernel/task_syscall.go:239 +0xba fp=0xc000573ab0 sp=0xc0005739d0 pc=0xd6189a
gvisor.dev/gvisor/pkg/sentry/kernel.(*Task).doSyscallEnter(0xc0005aca80, 0x133, 0x3, 0x20001540, 0x1, 0x4000, 0x1, 0x1, 0x137298b, 0x2d12694)
	pkg/sentry/kernel/task_syscall.go:199 +0x10f fp=0xc000573b60 sp=0xc000573ab0 pc=0xd611af
gvisor.dev/gvisor/pkg/sentry/kernel.(*Task).doSyscall(0xc0005aca80, 0x2, 0xc0005aca80)
	pkg/sentry/kernel/task_syscall.go:174 +0x1ea fp=0xc000573ca0 sp=0xc000573b60 pc=0xd6094a
gvisor.dev/gvisor/pkg/sentry/kernel.(*runApp).execute(0x0, 0xc0005aca80, 0x1a6f4a0, 0x0)
	pkg/sentry/kernel/task_run.go:282 +0x12a7 fp=0xc000573ed8 sp=0xc000573ca0 pc=0xd4c2c7
gvisor.dev/gvisor/pkg/sentry/kernel.(*Task).run(0xc0005aca80, 0xd)
	pkg/sentry/kernel/task_run.go:97 +0x398 fp=0xc000573fd0 sp=0xc000573ed8 pc=0xd4a3f8
runtime.goexit()
	src/runtime/asm_amd64.s:1374 +0x1 fp=0xc000573fd8 sp=0xc000573fd0 pc=0x4745e1
created by gvisor.dev/gvisor/pkg/sentry/kernel.(*Task).Start
	pkg/sentry/kernel/task_start.go:323 +0x1a5
