# Copyright 2025 syzkaller project authors. All rights reserved.
# Use of this source code is governed by Apache 2 LICENSE that can be found in the LICENSE file.

resources:
  - https://github.com/argoproj/argo-workflows/releases/download/v3.6.2/install.yaml
  - ../../controller
  - ../../dashboard
  - ../../series-tracker
  - ../../kernel-disk
  - ../../reporter
  - ../../workflow
  - network-deny-all.yaml
  - network-policy-controller.yaml
  - network-policy-git-access.yaml
  - workflow-roles.yaml

patches:
  - patch-argo-controller.yaml

patches:
  - target:
      kind: Deployment
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/imagePullPolicy
        value: IfNotPresent
  - target:
      kind: ConfigMap
      name: workflow-controller-configmap
    patch: |-
      - op: replace
        path: /data
        value:
          workflowDefaults:
            serviceAccountName: argo-executor-ksa
